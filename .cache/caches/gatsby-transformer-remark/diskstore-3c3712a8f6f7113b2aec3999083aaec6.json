{"expireTime":9007200866843161000,"key":"transformer-remark-markdown-html-ast-d8bbedbda393306b9e8927af844794d9-gatsby-remark-relative-imagesgatsby-remark-katexgatsby-remark-imagesgatsby-remark-responsive-iframegatsby-remark-autolink-headersgatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-smartypantsgatsby-remark-external-links-","val":{"type":"root","children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"みなさんこんにちは。夏ですね。\n僕もついに部活動が再開し、ワクワクドキドキな訳ですが、一昨日の夜顧問からこんな連絡がきました。","position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":3,"column":48,"offset":64}}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":3,"column":48,"offset":64}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">- 毎朝5時20分までに検温を行い、結果をGoogleFormから報告してください\n- 報告がなかった部員は朝練の参加を認めません</code></pre></div>","position":{"start":{"line":5,"column":1,"offset":66},"end":{"line":8,"column":4,"offset":139}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"そもそも朝練が6時半から始まる時点でイッているので5時20分に連絡しろと言われてもさほど驚かなかったのですが、ここで一つ問題が発生しました。","position":{"start":{"line":10,"column":1,"offset":141},"end":{"line":10,"column":71,"offset":211}}}],"position":{"start":{"line":10,"column":1,"offset":141},"end":{"line":10,"column":71,"offset":211}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"というのも僕は普段朝5時に起き、そのままパンをかじりながら自転車で駅に向かうので、検温をする時間がないのです。もう少し早起きすれば済む話なのですが、4時起きは流石にきついし体がもたないのでやりたくない。かといって5時に起きて検温なんかしていたら朝練そのものに遅れてしまう。","position":{"start":{"line":12,"column":1,"offset":213},"end":{"line":12,"column":137,"offset":349}}}],"position":{"start":{"line":12,"column":1,"offset":213},"end":{"line":12,"column":137,"offset":349}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"というわけで、朝5時くらいに、心配されない程度の体温をよしなに指定のFormに入力して送信してくれるプログラムを作りたいと思います。","position":{"start":{"line":14,"column":1,"offset":351},"end":{"line":14,"column":67,"offset":417}}}],"position":{"start":{"line":14,"column":1,"offset":351},"end":{"line":14,"column":67,"offset":417}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"seleniumでフォームを送信する","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#selenium%E3%81%A7%E3%83%95%E3%82%A9%E3%83%BC%E3%83%A0%E3%82%92%E9%80%81%E4%BF%A1%E3%81%99%E3%82%8B","aria-label":"seleniumでフォームを送信する permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Seleniumでフォームを送信する","position":{"start":{"line":16,"column":4,"offset":422},"end":{"line":16,"column":22,"offset":440}}}],"position":{"start":{"line":16,"column":1,"offset":419},"end":{"line":16,"column":22,"offset":440}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"本物のフォームを使ってやると僕の身元がバレてしまうので、今回は","position":{"start":{"line":17,"column":1,"offset":441},"end":{"line":17,"column":32,"offset":472}}},{"type":"element","tagName":"a","properties":{"href":"https://docs.google.com/forms/d/e/1FAIpQLScGgZ8dsBkcSVutvW3JgDLqy3pIEKk12ucjiA8mNQrKopILog/viewform","target":"_blank","rel":"nofollow noopener noreferrer"},"children":[{"type":"text","value":"テスト用に僕が作成した本物と同じ内容のフォーム","position":{"start":{"line":17,"column":33,"offset":473},"end":{"line":17,"column":56,"offset":496}}}],"position":{"start":{"line":17,"column":32,"offset":472},"end":{"line":17,"column":158,"offset":598}}},{"type":"text","value":"で実装したいと思います。","position":{"start":{"line":17,"column":158,"offset":598},"end":{"line":17,"column":170,"offset":610}}}],"position":{"start":{"line":17,"column":1,"offset":441},"end":{"line":17,"column":170,"offset":610}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"初期値入力つきurlを用意する","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#%E5%88%9D%E6%9C%9F%E5%80%A4%E5%85%A5%E5%8A%9B%E3%81%A4%E3%81%8Durl%E3%82%92%E7%94%A8%E6%84%8F%E3%81%99%E3%82%8B","aria-label":"初期値入力つきurlを用意する permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"初期値入力つきURLを用意する","position":{"start":{"line":18,"column":5,"offset":615},"end":{"line":18,"column":20,"offset":630}}}],"position":{"start":{"line":18,"column":1,"offset":611},"end":{"line":18,"column":20,"offset":630}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Google Formは、パラメータをつけることで各質問の値を入力した状態でURLを開くことができます。\n普通にフォームを開く際のURLは","position":{"start":{"line":19,"column":1,"offset":631},"end":{"line":20,"column":17,"offset":700}}}],"position":{"start":{"line":19,"column":1,"offset":631},"end":{"line":20,"column":17,"offset":700}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://docs.google.com/forms/d/e/1FAIpQLScGgZ8dsBkcSVutvW3JgDLqy3pIEKk12ucjiA8mNQrKopILog/viewform?usp=sf_link","target":"_blank","rel":"nofollow noopener noreferrer"},"children":[{"type":"text","value":"https://docs.google.com/forms/d/e/1FAIpQLScGgZ8dsBkcSVutvW3JgDLqy3pIEKk12ucjiA8mNQrKopILog/viewform?usp=sf_link","position":{"start":{"line":22,"column":1,"offset":702},"end":{"line":22,"column":112,"offset":813}}}],"position":{"start":{"line":22,"column":1,"offset":702},"end":{"line":22,"column":112,"offset":813}}}],"position":{"start":{"line":22,"column":1,"offset":702},"end":{"line":22,"column":112,"offset":813}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"こんな感じでviewformの後に「usp=sf","position":{"start":{"line":24,"column":1,"offset":815},"end":{"line":24,"column":25,"offset":839}}},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"link」というパラメータがついています。このパラメータは事前入力のない、ピュアな回答フォームであることを示しているので、まずここを「usp=pp","position":{"start":{"line":24,"column":26,"offset":840},"end":{"line":24,"column":99,"offset":913}}}],"position":{"start":{"line":24,"column":25,"offset":839},"end":{"line":24,"column":100,"offset":914}}},{"type":"text","value":"url」に変えて、事前入力があることを知らせてあげます。\n","position":{"start":{"line":24,"column":100,"offset":914},"end":{"line":25,"column":1,"offset":943}}},{"type":"text","value":" ","position":{"start":{"line":25,"column":1,"offset":943},"end":{"line":25,"column":7,"offset":949}}},{"type":"element","tagName":"br","properties":{},"children":[],"position":{"start":{"line":25,"column":7,"offset":949},"end":{"line":26,"column":1,"offset":952}}},{"type":"text","value":"\n"},{"type":"text","value":"","position":{"start":{"line":26,"column":1,"offset":952},"end":{"line":26,"column":7,"offset":958}}},{"type":"element","tagName":"br","properties":{},"children":[],"position":{"start":{"line":26,"column":7,"offset":958},"end":{"line":27,"column":1,"offset":961}}},{"type":"text","value":"\n"},{"type":"text","value":"そしたら次に各質問の回答をパラメータに入力していきます。フォームの各質問を識別する番号があるので、Chromeの検証画面で質問のdivを探し、2階層目で以下のような番号を探します。\n","position":{"start":{"line":27,"column":1,"offset":961},"end":{"line":28,"column":1,"offset":1052}}},{"type":"element","tagName":"img","properties":{"src":"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/502570/d48564de-3d9c-07e0-7aec-755e1b4444d5.jpeg","alt":"スクリーンショット 2020-08-07 16.56.07.jpg"},"children":[],"position":{"start":{"line":28,"column":1,"offset":1052},"end":{"line":28,"column":147,"offset":1198}}},{"type":"text","value":"\n番号を見つけたら","position":{"start":{"line":28,"column":147,"offset":1198},"end":{"line":29,"column":9,"offset":1207}}},{"type":"raw","value":"<code class=\"language-text\">entry.番号=回答内容</code>","position":{"start":{"line":29,"column":9,"offset":1207},"end":{"line":29,"column":28,"offset":1226}}},{"type":"text","value":"の形でパラメータを加えます。今回は名前と体温をテキストで入力するので以下のようなURLになります。","position":{"start":{"line":29,"column":28,"offset":1226},"end":{"line":29,"column":77,"offset":1275}}}],"position":{"start":{"line":24,"column":1,"offset":815},"end":{"line":29,"column":77,"offset":1275}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://docs.google.com/forms/d/e/1FAIpQLScGgZ8dsBkcSVutvW3JgDLqy3pIEKk12ucjiA8mNQrKopILog/viewform?usp=pp_url&entry.1534939278=%E8%8D%92%E5%B7%9D%E6%99%BA%E5%89%87&entry.511939456=36.5","target":"_blank","rel":"nofollow noopener noreferrer"},"children":[{"type":"text","value":"https://docs.google.com/forms/d/e/1FAIpQLScGgZ8dsBkcSVutvW3JgDLqy3pIEKk12ucjiA8mNQrKopILog/viewform?usp=pp_url&entry.1534939278=荒川智則&entry.511939456=36.5","position":{"start":{"line":31,"column":1,"offset":1277},"end":{"line":31,"column":154,"offset":1430}}}],"position":{"start":{"line":31,"column":1,"offset":1277},"end":{"line":31,"column":154,"offset":1430}}},{"type":"text","value":"\nしかしこのままだと毎日36.5度を報告することになり、流石に怪しまれるので、乱数で良い感じに値を振ります。","position":{"start":{"line":31,"column":154,"offset":1430},"end":{"line":32,"column":54,"offset":1484}}}],"position":{"start":{"line":31,"column":1,"offset":1277},"end":{"line":32,"column":54,"offset":1484}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 36.1~36.7の間でランダムに値を生成して文字列変換</span>\nbody_temp <span class=\"token operator\">=</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token number\">36</span> <span class=\"token operator\">+</span> random<span class=\"token punctuation\">.</span>randint<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">)</span><span class=\"token operator\">/</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># URLの最後に加える</span>\nurl <span class=\"token operator\">=</span> <span class=\"token string\">'https://docs.google.com/forms/d/e/1FAIpQLScGgZ8dsBkcSVutvW3JgDLqy3pIEKk12ucjiA8mNQrKopILog/viewform?usp=pp_url&amp;entry.1534939278=荒川智則&amp;entry.511939456='</span><span class=\"token operator\">+</span>body_temp</code></pre></div>","position":{"start":{"line":34,"column":1,"offset":1486},"end":{"line":39,"column":4,"offset":1756}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"seleniumで自動提出","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#selenium%E3%81%A7%E8%87%AA%E5%8B%95%E6%8F%90%E5%87%BA","aria-label":"seleniumで自動提出 permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Seleniumで自動提出","position":{"start":{"line":41,"column":5,"offset":1762},"end":{"line":41,"column":18,"offset":1775}}}],"position":{"start":{"line":41,"column":1,"offset":1758},"end":{"line":41,"column":18,"offset":1775}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"URLが完成したら、あとはSeleniumでURLを開き、ポチッと提出ボタンを押してもらうだけです。","position":{"start":{"line":42,"column":1,"offset":1776},"end":{"line":42,"column":51,"offset":1826}}}],"position":{"start":{"line":42,"column":1,"offset":1776},"end":{"line":42,"column":51,"offset":1826}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># SeleniumとChromedriverをpipでインストールしておく</span>\n<span class=\"token keyword\">from</span> selenium <span class=\"token keyword\">import</span> webdriver\n<span class=\"token keyword\">import</span> chromedriver_binary\n<span class=\"token keyword\">import</span> time\n<span class=\"token keyword\">import</span> random\n\nbody_temp <span class=\"token operator\">=</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token number\">36</span> <span class=\"token operator\">+</span> random<span class=\"token punctuation\">.</span>randint<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">)</span><span class=\"token operator\">/</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span>\nurl <span class=\"token operator\">=</span> <span class=\"token string\">'https://docs.google.com/forms/d/e/1FAIpQLScGgZ8dsBkcSVutvW3JgDLqy3pIEKk12ucjiA8mNQrKopILog/viewform?usp=pp_url&amp;entry.1534939278=荒川智則&amp;entry.511939456='</span><span class=\"token operator\">+</span>body_temp\n\n<span class=\"token comment\"># クリックの関数</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">click</span><span class=\"token punctuation\">(</span>xpath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    driver<span class=\"token punctuation\">.</span>find_element_by_xpath<span class=\"token punctuation\">(</span>xpath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># パスワード入力の関数</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">insert_pw</span><span class=\"token punctuation\">(</span>xpath<span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    driver<span class=\"token punctuation\">.</span>find_element_by_xpath<span class=\"token punctuation\">(</span>xpath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>send_keys<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span>\n\ndriver <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>Chrome<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ndriver<span class=\"token punctuation\">.</span>implicitly_wait<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\ndriver<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span>\n\nmoving_login_button <span class=\"token operator\">=</span> <span class=\"token string\">'/html/body/div[2]/div/div[2]/div[3]/div[2]'</span>\ntime<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Googleアカウントでのログインが必要な場合はログインする</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">.</span>find_elements_by_xpath<span class=\"token punctuation\">(</span>moving_login_button<span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n  click<span class=\"token punctuation\">(</span>moving_login_button<span class=\"token punctuation\">)</span>\n  login_id <span class=\"token operator\">=</span> <span class=\"token string\">\"{Googleアカウントのメアド}\"</span>\n  login_id_xpath <span class=\"token operator\">=</span> <span class=\"token string\">'/html/body/div[1]/div[1]/div[2]/div/div[2]/div/div/div[2]/div/div[1]/div/form/span/section/div/div/div[1]/div/div[1]/div/div[1]/input'</span>\n  login_id_button <span class=\"token operator\">=</span> <span class=\"token string\">'/html/body/div[1]/div[1]/div[2]/div/div[2]/div/div/div[2]/div/div[2]/div/div[1]/div/div'</span>\n  insert_pw<span class=\"token punctuation\">(</span>login_id_xpath<span class=\"token punctuation\">,</span> login_id<span class=\"token punctuation\">)</span>\n  click<span class=\"token punctuation\">(</span>login_id_button<span class=\"token punctuation\">)</span>\n  time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n  login_pw <span class=\"token operator\">=</span> <span class=\"token string\">\"{Googleアカウントのパスワード}\"</span>\n  login_pw_xpath <span class=\"token operator\">=</span> <span class=\"token string\">'/html/body/div[1]/div[1]/div[2]/div/div[2]/div/div/div[2]/div/div[1]/div/form/span/section/div/div/div[1]/div[1]/div/div/div/div/div[1]/div/div[1]/input'</span>\n  login_pw_button <span class=\"token operator\">=</span> <span class=\"token string\">'/html/body/div[1]/div[1]/div[2]/div/div[2]/div/div/div[2]/div/div[2]/div/div[1]/div/div'</span>\n  insert_pw<span class=\"token punctuation\">(</span>login_pw_xpath<span class=\"token punctuation\">,</span> login_pw<span class=\"token punctuation\">)</span>\n  time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n  click<span class=\"token punctuation\">(</span>login_pw_button<span class=\"token punctuation\">)</span>\n\ntime<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\nsubmit_button <span class=\"token operator\">=</span> <span class=\"token string\">'//*[@id=\"mG61Hd\"]/div[2]/div/div[3]/div[1]/div/div'</span>\nclick<span class=\"token punctuation\">(</span>submit_button<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Done!\"</span><span class=\"token punctuation\">)</span>\n\ndriver<span class=\"token punctuation\">.</span>close\n<span class=\"token comment\"># メモリーを食うのでちゃんと終了しましょう</span>\ndriver<span class=\"token punctuation\">.</span>quit</code></pre></div>","position":{"start":{"line":44,"column":1,"offset":1828},"end":{"line":94,"column":4,"offset":3574}}},{"type":"text","value":"\n"},{"type":"raw","value":"<img width=\"500\" alt=\"スクリーンショット 2020-08-07 17.23.49.png\" src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/502570/8f8adde5-f6fe-62f3-ad8f-76d6fb22f50d.png\">","position":{"start":{"line":96,"column":1,"offset":3576},"end":{"line":96,"column":172,"offset":3747}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"しっかり送信できました。","position":{"start":{"line":98,"column":1,"offset":3749},"end":{"line":98,"column":13,"offset":3761}}}],"position":{"start":{"line":98,"column":1,"offset":3749},"end":{"line":98,"column":13,"offset":3761}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"定期イベントにする","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#%E5%AE%9A%E6%9C%9F%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%81%AB%E3%81%99%E3%82%8B","aria-label":"定期イベントにする permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"定期イベントにする","position":{"start":{"line":100,"column":4,"offset":3766},"end":{"line":100,"column":13,"offset":3775}}}],"position":{"start":{"line":100,"column":1,"offset":3763},"end":{"line":100,"column":13,"offset":3775}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"コードが書けたらあとは定期イベント化するだけなのですが、ここで少しつまづいたのでやり方を説明しておきます。\n","position":{"start":{"line":101,"column":1,"offset":3776},"end":{"line":102,"column":1,"offset":3830}}},{"type":"text","value":" ","position":{"start":{"line":102,"column":1,"offset":3830},"end":{"line":102,"column":7,"offset":3836}}},{"type":"element","tagName":"br","properties":{},"children":[],"position":{"start":{"line":102,"column":7,"offset":3836},"end":{"line":103,"column":1,"offset":3839}}},{"type":"text","value":"\n"},{"type":"text","value":"","position":{"start":{"line":103,"column":1,"offset":3839},"end":{"line":103,"column":7,"offset":3845}}},{"type":"element","tagName":"br","properties":{},"children":[],"position":{"start":{"line":103,"column":7,"offset":3845},"end":{"line":104,"column":1,"offset":3848}}},{"type":"text","value":"\n"},{"type":"text","value":"当初予定していた方法としてはAutomatorでアプリ化し、カレンダーに入れて毎日実行する方法(","position":{"start":{"line":104,"column":1,"offset":3848},"end":{"line":104,"column":49,"offset":3896}}},{"type":"element","tagName":"a","properties":{"href":"https://qiita.com/baraobara/items/73d753c678e5c0e72f46#4-mac%E3%81%AE%E3%83%87%E3%83%95%E3%82%A9%E3%83%AB%E3%83%88%E3%81%AEautomator%E3%82%92%E7%94%A8%E3%81%84%E3%81%A6mac%E5%86%85%E3%82%A2%E3%83%97%E3%83%AA%E3%82%92%E4%BD%9C%E3%82%8B","target":"_blank","rel":"nofollow noopener noreferrer"},"children":[{"type":"text","value":"参考","position":{"start":{"line":104,"column":50,"offset":3897},"end":{"line":104,"column":52,"offset":3899}}}],"position":{"start":{"line":104,"column":49,"offset":3896},"end":{"line":104,"column":289,"offset":4136}}},{"type":"text","value":")。これなら報告しなくて良い日はカレンダーから外せば良いし、完璧なはず。と思ったのですが、PCをシャットダウンしていると動作しないためボツ。crontabに設定して定期イベント化する方法も同様の理由でボツ。","position":{"start":{"line":104,"column":289,"offset":4136},"end":{"line":104,"column":392,"offset":4239}}}],"position":{"start":{"line":101,"column":1,"offset":3776},"end":{"line":104,"column":392,"offset":4239}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"結局臨機応変にイベントの変更はできないものの、PCの状態にかかわらず実行してくれるAWSのLambdaを使用することに決めました。(Lambdaの使い方は","position":{"start":{"line":106,"column":1,"offset":4241},"end":{"line":106,"column":78,"offset":4318}}},{"type":"element","tagName":"a","properties":{"href":"https://www.wakuwakubank.com/posts/519-aws-lambda-introduction/","target":"_blank","rel":"nofollow noopener noreferrer"},"children":[{"type":"text","value":"このサイト","position":{"start":{"line":106,"column":79,"offset":4319},"end":{"line":106,"column":84,"offset":4324}}}],"position":{"start":{"line":106,"column":78,"offset":4318},"end":{"line":106,"column":150,"offset":4390}}},{"type":"text","value":"とかが参考になりました)","position":{"start":{"line":106,"column":150,"offset":4390},"end":{"line":106,"column":162,"offset":4402}}}],"position":{"start":{"line":106,"column":1,"offset":4241},"end":{"line":106,"column":162,"offset":4402}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"lambdaのレイヤーにseleniumとchromedriver、headless-chromiumを上げる","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#lambda%E3%81%AE%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E3%81%ABselenium%E3%81%A8chromedriver%E3%80%81headless-chromium%E3%82%92%E4%B8%8A%E3%81%92%E3%82%8B","aria-label":"lambdaのレイヤーにseleniumとchromedriver、headless chromiumを上げる permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"LambdaのレイヤーにSeleniumとChromedriver、headless-chromiumを上げる","position":{"start":{"line":108,"column":5,"offset":4408},"end":{"line":108,"column":60,"offset":4463}}}],"position":{"start":{"line":108,"column":1,"offset":4404},"end":{"line":108,"column":60,"offset":4463}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Lambdaでライブラリを使うには各フォルダをzipに圧縮してレイヤーにアップロードする必要があります。今回はSeleniumとChromeのWebdriverであるChromedriver、それからChromeを開かずにスクレイピングを行うためのheadless-chromiumを使用するので、それぞれzipに圧縮してレイヤーに上げていきます。","position":{"start":{"line":109,"column":1,"offset":4464},"end":{"line":109,"column":175,"offset":4638}}}],"position":{"start":{"line":109,"column":1,"offset":4464},"end":{"line":109,"column":175,"offset":4638}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h4","properties":{"id":"1-selenium","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#1-selenium","aria-label":"1 selenium permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"1. Selenium","position":{"start":{"line":110,"column":6,"offset":4644},"end":{"line":110,"column":17,"offset":4655}}}],"position":{"start":{"line":110,"column":1,"offset":4639},"end":{"line":110,"column":17,"offset":4655}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">mkdir selenium\ncd selenium\nmkdir python\ncd python\npip install selenium -t .\ncd ../\nzip -r selenium.zip ./python</code></pre></div>","position":{"start":{"line":111,"column":1,"offset":4656},"end":{"line":119,"column":4,"offset":4775}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"できたzipファイルをそのままレイヤーにアップロードします。","position":{"start":{"line":120,"column":1,"offset":4776},"end":{"line":120,"column":31,"offset":4806}}}],"position":{"start":{"line":120,"column":1,"offset":4776},"end":{"line":120,"column":31,"offset":4806}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h4","properties":{"id":"2-chromedriverとheadless-chromium","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#2-chromedriver%E3%81%A8headless-chromium","aria-label":"2 chromedriverとheadless chromium permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"2. Chromedriverとheadless-chromium","position":{"start":{"line":121,"column":6,"offset":4812},"end":{"line":121,"column":39,"offset":4845}}}],"position":{"start":{"line":121,"column":1,"offset":4807},"end":{"line":121,"column":39,"offset":4845}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">curl https://github.com/adieuadieu/serverless-chrome/releases/download/v1.0.0-55/stable-headless-chromium-amazonlinux-2017-03.zip &gt; headless-chromium.zip\ncurl https://chromedriver.storage.googleapis.com/2.43/chromedriver_linux64.zip &gt; chromedriver.zip</code></pre></div>","position":{"start":{"line":122,"column":1,"offset":4846},"end":{"line":125,"column":4,"offset":5105}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"できた二つのzipファイルを解凍し、headless-chromeフォルダにまとめます。その後そのheadless-chromeをzipに圧縮してレイヤーにアップロードします。","position":{"start":{"line":126,"column":1,"offset":5106},"end":{"line":126,"column":89,"offset":5194}}}],"position":{"start":{"line":126,"column":1,"offset":5106},"end":{"line":126,"column":89,"offset":5194}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h4","properties":{"id":"3-レイヤーを関数に適用","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#3-%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E3%82%92%E9%96%A2%E6%95%B0%E3%81%AB%E9%81%A9%E7%94%A8","aria-label":"3 レイヤーを関数に適用 permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"3. レイヤーを関数に適用","position":{"start":{"line":128,"column":6,"offset":5201},"end":{"line":128,"column":19,"offset":5214}}}],"position":{"start":{"line":128,"column":1,"offset":5196},"end":{"line":128,"column":19,"offset":5214}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"関数の下にある「Layers」を押し、下の「レイヤーの追加」ボタンから二つのレイヤを追加します\n","position":{"start":{"line":129,"column":1,"offset":5215},"end":{"line":130,"column":1,"offset":5263}}},{"type":"raw","value":"<img width=\"1612\" alt=\"スクリーンショット 2020-08-07 18.36.45.png\" src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/502570/27d63d99-6a12-7370-3e32-46851977176f.png\">","position":{"start":{"line":130,"column":1,"offset":5263},"end":{"line":130,"column":173,"offset":5435}}}],"position":{"start":{"line":129,"column":1,"offset":5215},"end":{"line":130,"column":173,"offset":5435}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h4","properties":{"id":"注意","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#%E6%B3%A8%E6%84%8F","aria-label":"注意 permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"※注意※","position":{"start":{"line":133,"column":6,"offset":5443},"end":{"line":133,"column":10,"offset":5447}}}],"position":{"start":{"line":133,"column":1,"offset":5438},"end":{"line":133,"column":10,"offset":5447}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Lambda関数のランタイムをPython3.8にするとChromedriverが動いてくれなかった(原因不明)ので、ランタイムはPython3.6か3.7に設定することをお勧めします。","position":{"start":{"line":134,"column":3,"offset":5450},"end":{"line":134,"column":96,"offset":5543}}}],"position":{"start":{"line":134,"column":1,"offset":5448},"end":{"line":134,"column":96,"offset":5543}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"headless-chromiumとChromedriverの間に互換性がないと動作しないので","position":{"start":{"line":135,"column":3,"offset":5546},"end":{"line":135,"column":50,"offset":5593}}},{"type":"element","tagName":"a","properties":{"href":"http://chromedriver.chromium.org/downloads","target":"_blank","rel":"nofollow noopener noreferrer"},"children":[{"type":"text","value":"こちら","position":{"start":{"line":135,"column":51,"offset":5594},"end":{"line":135,"column":54,"offset":5597}}}],"position":{"start":{"line":135,"column":50,"offset":5593},"end":{"line":135,"column":99,"offset":5642}}},{"type":"text","value":"から最新版を入手しても動作しない可能性があります。","position":{"start":{"line":135,"column":99,"offset":5642},"end":{"line":135,"column":124,"offset":5667}}}],"position":{"start":{"line":135,"column":1,"offset":5544},"end":{"line":135,"column":124,"offset":5667}}},{"type":"text","value":"\n"}],"position":{"start":{"line":134,"column":1,"offset":5448},"end":{"line":135,"column":124,"offset":5667}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"lambda用にコードを少し変える","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#lambda%E7%94%A8%E3%81%AB%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E5%B0%91%E3%81%97%E5%A4%89%E3%81%88%E3%82%8B","aria-label":"lambda用にコードを少し変える permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Lambda用にコードを少し変える","position":{"start":{"line":137,"column":5,"offset":5673},"end":{"line":137,"column":22,"offset":5690}}}],"position":{"start":{"line":137,"column":1,"offset":5669},"end":{"line":137,"column":22,"offset":5690}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"筆者は今までCloud9以外のAWSツールを使ったことがないへっぽこコーダーなので、色んなサイトの見様見真似でなんとかLambdaで動くコードにしました。先人に感謝。","position":{"start":{"line":138,"column":1,"offset":5691},"end":{"line":138,"column":84,"offset":5774}}}],"position":{"start":{"line":138,"column":1,"offset":5691},"end":{"line":138,"column":84,"offset":5774}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> json\n<span class=\"token keyword\">from</span> selenium <span class=\"token keyword\">import</span> webdriver\n<span class=\"token keyword\">import</span> time\n<span class=\"token keyword\">import</span> random\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">lambda_handler</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">,</span> context<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    body_temp <span class=\"token operator\">=</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token number\">36</span> <span class=\"token operator\">+</span> random<span class=\"token punctuation\">.</span>randint<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">)</span><span class=\"token operator\">/</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span>\n    url <span class=\"token operator\">=</span> <span class=\"token string\">'https://docs.google.com/forms/d/e/1FAIpQLScGgZ8dsBkcSVutvW3JgDLqy3pIEKk12ucjiA8mNQrKopILog/viewform?usp=pp_url&amp;entry.1534939278=荒川智則&amp;entry.511939456='</span><span class=\"token operator\">+</span>body_temp\n    options <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>ChromeOptions<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    options<span class=\"token punctuation\">.</span>binary_location <span class=\"token operator\">=</span> <span class=\"token string\">'/opt/headless-chrome/headless-chromium'</span>\n    <span class=\"token comment\"># このオプション4つを付けないとChromeは起動せずエラーになります</span>\n    options<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span><span class=\"token string\">'--headless'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># サーバーレスでChromeを起動</span>\n    options<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span><span class=\"token string\">'--no-sandbox'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># sandbox外でChromeを起動</span>\n    options<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span><span class=\"token string\">'--single-process'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># タブ/サイトごとのマルチプロセスではなく、シングルプロセスへ切り替える</span>\n    options<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span><span class=\"token string\">'--disable-dev-shm-usage'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># メモリファイルの出力場所を変える</span>\n    driver <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>Chrome<span class=\"token punctuation\">(</span><span class=\"token string\">'/opt/headless-chrome/chromedriver'</span><span class=\"token punctuation\">,</span>options <span class=\"token operator\">=</span> options<span class=\"token punctuation\">)</span>\n    driver<span class=\"token punctuation\">.</span>implicitly_wait<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    driver<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span>\n    \n    <span class=\"token keyword\">def</span> <span class=\"token function\">click</span><span class=\"token punctuation\">(</span>xpath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        driver<span class=\"token punctuation\">.</span>find_element_by_xpath<span class=\"token punctuation\">(</span>xpath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">insert_pw</span><span class=\"token punctuation\">(</span>xpath<span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        driver<span class=\"token punctuation\">.</span>find_element_by_xpath<span class=\"token punctuation\">(</span>xpath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>send_keys<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span>\n    \n    moving_login_button <span class=\"token operator\">=</span> <span class=\"token string\">'/html/body/div[2]/div/div[2]/div[3]/div[2]'</span>\n    time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">.</span>find_elements_by_xpath<span class=\"token punctuation\">(</span>moving_login_button<span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        click<span class=\"token punctuation\">(</span>moving_login_button<span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># 環境変数でMY_GMAILにGoogleアカウントのメアドを設定してください</span>\n        login_id <span class=\"token operator\">=</span> MY_GMAIL\n        login_id_xpath <span class=\"token operator\">=</span> <span class=\"token string\">'/html/body/div[1]/div[1]/div[2]/div/div[2]/div/div/div[2]/div/div[1]/div/form/span/section/div/div/div[1]/div/div[1]/div/div[1]/input'</span>\n        login_id_button <span class=\"token operator\">=</span> <span class=\"token string\">'/html/body/div[1]/div[1]/div[2]/div/div[2]/div/div/div[2]/div/div[2]/div/div[1]/div/div'</span>\n        insert_pw<span class=\"token punctuation\">(</span>login_id_xpath<span class=\"token punctuation\">,</span> login_id<span class=\"token punctuation\">)</span>\n        click<span class=\"token punctuation\">(</span>login_id_button<span class=\"token punctuation\">)</span>\n        time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># 環境変数でMY_PASSWORDにGoogleアカウントのパスワードを設定してください</span>\n        login_pw <span class=\"token operator\">=</span> MY_PASSWORD\n        login_pw_xpath <span class=\"token operator\">=</span> <span class=\"token string\">'/html/body/div[1]/div[1]/div[2]/div/div[2]/div/div/div[2]/div/div[1]/div/form/span/section/div/div/div[1]/div[1]/div/div/div/div/div[1]/div/div[1]/input'</span>\n        login_pw_button <span class=\"token operator\">=</span> <span class=\"token string\">'/html/body/div[1]/div[1]/div[2]/div/div[2]/div/div/div[2]/div/div[2]/div/div[1]/div/div'</span>\n        insert_pw<span class=\"token punctuation\">(</span>login_pw_xpath<span class=\"token punctuation\">,</span> login_pw<span class=\"token punctuation\">)</span>\n        time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n        click<span class=\"token punctuation\">(</span>login_pw_button<span class=\"token punctuation\">)</span>\n    time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    submit_button <span class=\"token operator\">=</span> <span class=\"token string\">'//*[@id=\"mG61Hd\"]/div[2]/div/div[3]/div[1]/div/div'</span>\n    click<span class=\"token punctuation\">(</span>submit_button<span class=\"token punctuation\">)</span>\n    driver<span class=\"token punctuation\">.</span>close\n    driver<span class=\"token punctuation\">.</span>quit\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">'statusCode'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">'body'</span><span class=\"token punctuation\">:</span> json<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span><span class=\"token string\">'Form submission success!!'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":140,"column":1,"offset":5776},"end":{"line":194,"column":4,"offset":8223}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h4","properties":{"id":"注意点","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#%E6%B3%A8%E6%84%8F%E7%82%B9","aria-label":"注意点 permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"注意点","position":{"start":{"line":196,"column":6,"offset":8230},"end":{"line":196,"column":9,"offset":8233}}}],"position":{"start":{"line":196,"column":1,"offset":8225},"end":{"line":196,"column":9,"offset":8233}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Chromeの起動オプション","position":{"start":{"line":197,"column":3,"offset":8236},"end":{"line":197,"column":17,"offset":8250}}},{"type":"raw","value":"<code class=\"language-text\">--headless</code>","position":{"start":{"line":197,"column":17,"offset":8250},"end":{"line":197,"column":33,"offset":8266}}},{"type":"text","value":",","position":{"start":{"line":197,"column":33,"offset":8266},"end":{"line":197,"column":34,"offset":8267}}},{"type":"raw","value":"<code class=\"language-text\">--no-sandbox</code>","position":{"start":{"line":197,"column":34,"offset":8267},"end":{"line":197,"column":52,"offset":8285}}},{"type":"text","value":",","position":{"start":{"line":197,"column":52,"offset":8285},"end":{"line":197,"column":53,"offset":8286}}},{"type":"raw","value":"<code class=\"language-text\">single-process</code>","position":{"start":{"line":197,"column":53,"offset":8286},"end":{"line":197,"column":73,"offset":8306}}},{"type":"text","value":",","position":{"start":{"line":197,"column":73,"offset":8306},"end":{"line":197,"column":74,"offset":8307}}},{"type":"raw","value":"<code class=\"language-text\">--disable-dev-shm-usage</code>","position":{"start":{"line":197,"column":74,"offset":8307},"end":{"line":197,"column":103,"offset":8336}}},{"type":"text","value":"を付けないとLambda上で正常に起動せず、エラーが出ます。各オプションについての詳細は","position":{"start":{"line":197,"column":103,"offset":8336},"end":{"line":197,"column":147,"offset":8380}}},{"type":"element","tagName":"a","properties":{"href":"http://chrome.half-moon.org/43.html","target":"_blank","rel":"nofollow noopener noreferrer"},"children":[{"type":"text","value":"こちら","position":{"start":{"line":197,"column":148,"offset":8381},"end":{"line":197,"column":151,"offset":8384}}}],"position":{"start":{"line":197,"column":147,"offset":8380},"end":{"line":197,"column":189,"offset":8422}}},{"type":"text","value":"をご覧ください","position":{"start":{"line":197,"column":189,"offset":8422},"end":{"line":197,"column":196,"offset":8429}}}],"position":{"start":{"line":197,"column":1,"offset":8234},"end":{"line":197,"column":196,"offset":8429}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"レイヤーにアップロードしたファイルはoptディレクトリの配下に置かれます。パスを指定する際はopt/ディレクトリ名/…の形で表記しましょう","position":{"start":{"line":198,"column":3,"offset":8432},"end":{"line":198,"column":74,"offset":8503}}}],"position":{"start":{"line":198,"column":1,"offset":8430},"end":{"line":198,"column":74,"offset":8503}}},{"type":"text","value":"\n"}],"position":{"start":{"line":197,"column":1,"offset":8234},"end":{"line":198,"column":74,"offset":8503}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"cloudwatch-eventsでトリガーを設定","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#cloudwatch-events%E3%81%A7%E3%83%88%E3%83%AA%E3%82%AC%E3%83%BC%E3%82%92%E8%A8%AD%E5%AE%9A","aria-label":"cloudwatch eventsでトリガーを設定 permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"CloudWatch Eventsでトリガーを設定","position":{"start":{"line":200,"column":5,"offset":8509},"end":{"line":200,"column":30,"offset":8534}}}],"position":{"start":{"line":200,"column":1,"offset":8505},"end":{"line":200,"column":30,"offset":8534}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"関数の「Layers」をクリックして「トリガーを追加をクリック」し、ドロップダウンから「EventBridge (CloudWatch Events)」を選択します。","position":{"start":{"line":201,"column":4,"offset":8538},"end":{"line":201,"column":87,"offset":8621}}}],"position":{"start":{"line":201,"column":1,"offset":8535},"end":{"line":201,"column":87,"offset":8621}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"ルールは「新規ルールの作成」で任意のルール名を入力。ルールタイプをスケジュール式にし、今回は毎日朝5時なので","position":{"start":{"line":202,"column":4,"offset":8625},"end":{"line":202,"column":58,"offset":8679}}},{"type":"raw","value":"<code class=\"language-text\">corn(0 20 ? * * *)</code>","position":{"start":{"line":202,"column":58,"offset":8679},"end":{"line":202,"column":82,"offset":8703}}},{"type":"text","value":"と入力(LambdaはUTCでトリガーされるので9時間前をセットすることに留意)。トリガーを有効にして「追加」をクリックします。（cronの書き方は","position":{"start":{"line":202,"column":82,"offset":8703},"end":{"line":202,"column":156,"offset":8777}}},{"type":"element","tagName":"a","properties":{"href":"https://qiita.com/tossh/items/e135bd063a50087c3d6a","target":"_blank","rel":"nofollow noopener noreferrer"},"children":[{"type":"text","value":"こちら","position":{"start":{"line":202,"column":157,"offset":8778},"end":{"line":202,"column":160,"offset":8781}}}],"position":{"start":{"line":202,"column":156,"offset":8777},"end":{"line":202,"column":213,"offset":8834}}},{"type":"text","value":"をご覧ください）","position":{"start":{"line":202,"column":213,"offset":8834},"end":{"line":202,"column":221,"offset":8842}}}],"position":{"start":{"line":202,"column":1,"offset":8622},"end":{"line":202,"column":221,"offset":8842}}},{"type":"text","value":"\n"}],"position":{"start":{"line":201,"column":1,"offset":8535},"end":{"line":202,"column":221,"offset":8842}}},{"type":"text","value":"\n"},{"type":"raw","value":"<img width=\"810\" alt=\"スクリーンショット 2020-08-07 18.56.44.png\" src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/502570/2c07b4d3-295d-7543-7de7-dc8b0efaf40b.png\">","position":{"start":{"line":204,"column":1,"offset":8844},"end":{"line":204,"column":172,"offset":9015}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"テスト","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#%E3%83%86%E3%82%B9%E3%83%88","aria-label":"テスト permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"テスト","position":{"start":{"line":207,"column":4,"offset":9021},"end":{"line":207,"column":7,"offset":9024}}}],"position":{"start":{"line":207,"column":1,"offset":9018},"end":{"line":207,"column":7,"offset":9024}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"最後にしっかり動くかテストしましょう。Lambda関数画面の「テスト」をクリックします。\n","position":{"start":{"line":208,"column":1,"offset":9025},"end":{"line":209,"column":1,"offset":9070}}},{"type":"raw","value":"<img width=\"1613\" alt=\"スクリーンショット 2020-08-07 18.51.28.png\" src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/502570/8418067e-0784-9b2c-feeb-624c132e277d.png\">","position":{"start":{"line":209,"column":1,"offset":9070},"end":{"line":209,"column":173,"offset":9242}}},{"type":"text","value":"\n大丈夫そうですね。","position":{"start":{"line":209,"column":173,"offset":9242},"end":{"line":210,"column":10,"offset":9252}}}],"position":{"start":{"line":208,"column":1,"offset":9025},"end":{"line":210,"column":10,"offset":9252}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"おわりに","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB","aria-label":"おわりに permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"おわりに","position":{"start":{"line":212,"column":4,"offset":9257},"end":{"line":212,"column":8,"offset":9261}}}],"position":{"start":{"line":212,"column":1,"offset":9254},"end":{"line":212,"column":8,"offset":9261}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"朝の検温はサボっていますが、寝る前にちゃんと測っているので安心してください。","position":{"start":{"line":213,"column":1,"offset":9262},"end":{"line":213,"column":39,"offset":9300}}}],"position":{"start":{"line":213,"column":1,"offset":9262},"end":{"line":213,"column":39,"offset":9300}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"参考文献","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE","aria-label":"参考文献 permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"参考文献","position":{"start":{"line":215,"column":4,"offset":9305},"end":{"line":215,"column":8,"offset":9309}}}],"position":{"start":{"line":215,"column":1,"offset":9302},"end":{"line":215,"column":8,"offset":9309}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://masakimisawa.com/selenium_headless-chrome_python_on_lambda/","target":"_blank","rel":"nofollow noopener noreferrer"},"children":[{"type":"text","value":"https://masakimisawa.com/selenium_headless-chrome_python_on_lambda/","position":{"start":{"line":216,"column":1,"offset":9310},"end":{"line":216,"column":68,"offset":9377}}}],"position":{"start":{"line":216,"column":1,"offset":9310},"end":{"line":216,"column":68,"offset":9377}}},{"type":"text","value":"\n","position":{"start":{"line":216,"column":68,"offset":9377},"end":{"line":217,"column":1,"offset":9378}}},{"type":"element","tagName":"a","properties":{"href":"https://github.com/heroku/heroku-buildpack-google-chrome/issues/56","target":"_blank","rel":"nofollow noopener noreferrer"},"children":[{"type":"text","value":"https://github.com/heroku/heroku-buildpack-google-chrome/issues/56","position":{"start":{"line":217,"column":1,"offset":9378},"end":{"line":217,"column":67,"offset":9444}}}],"position":{"start":{"line":217,"column":1,"offset":9378},"end":{"line":217,"column":67,"offset":9444}}},{"type":"text","value":"\n","position":{"start":{"line":217,"column":67,"offset":9444},"end":{"line":218,"column":1,"offset":9445}}},{"type":"element","tagName":"a","properties":{"href":"https://qiita.com/mishimay/items/afd7f247f101fbe25f30","target":"_blank","rel":"nofollow noopener noreferrer"},"children":[{"type":"text","value":"https://qiita.com/mishimay/items/afd7f247f101fbe25f30","position":{"start":{"line":218,"column":1,"offset":9445},"end":{"line":218,"column":54,"offset":9498}}}],"position":{"start":{"line":218,"column":1,"offset":9445},"end":{"line":218,"column":54,"offset":9498}}}],"position":{"start":{"line":216,"column":1,"offset":9310},"end":{"line":218,"column":54,"offset":9498}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":219,"column":1,"offset":9499}}}}