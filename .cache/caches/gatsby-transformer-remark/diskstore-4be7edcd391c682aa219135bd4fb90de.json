{"expireTime":9007200875866098000,"key":"transformer-remark-markdown-html-ast-e0598673883d2dcfb8e3af527b552e54-gatsby-remark-relative-imagesgatsby-remark-katexgatsby-remark-imagesgatsby-remark-responsive-iframegatsby-remark-autolink-headersgatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-smartypantsgatsby-remark-external-links-","val":{"type":"root","children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"暗号モードというのはブロック暗号において、長い平文を暗号化するための前置き的な手順です。言い換えれば暗号アルゴリズムの入力の決め方みたいなもの。\n僕自身で発展させた知見はないので","position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":3,"column":17,"offset":90}}},{"type":"element","tagName":"a","properties":{"href":"https://scrapbox.io/chicken/","target":"_blank","rel":"nofollow noopener noreferrer"},"children":[{"type":"text","value":"Scrapbox","position":{"start":{"line":3,"column":18,"offset":91},"end":{"line":3,"column":26,"offset":99}}}],"position":{"start":{"line":3,"column":17,"offset":90},"end":{"line":3,"column":57,"offset":130}}},{"type":"text","value":"の方に書こうかなとも思ったんだけど、見出し使うしある程度体系化されてるのでこっちに書きます。","position":{"start":{"line":3,"column":57,"offset":130},"end":{"line":3,"column":103,"offset":176}}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":3,"column":103,"offset":176}}},{"type":"text","value":"\n"},{"type":"raw","value":"<details>\n  <summary>目次</summary>\n  <ul>\n    <li>ECBモード</li>\n    <li>CBCモード</li>\n    <li>CTSモード</li>\n    <li>CFBモード</li>\n    <li>OFBモード</li>\n    <li>CTRモード</li>\n  </ul>\n</details>","position":{"start":{"line":5,"column":1,"offset":178},"end":{"line":15,"column":11,"offset":357}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"electric-codeblock-ecb","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#electric-codeblock-ecb","aria-label":"electric codeblock ecb permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Electric CodeBlock (ECB)","position":{"start":{"line":17,"column":4,"offset":362},"end":{"line":17,"column":28,"offset":386}}}],"position":{"start":{"line":17,"column":1,"offset":359},"end":{"line":17,"column":28,"offset":386}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"ブロックに区切られた暗号文をそのまま順番に暗号化して暗号文ブロックをつなぎ合わせる方法。最も単純かつ最も脆弱。","position":{"start":{"line":18,"column":1,"offset":387},"end":{"line":18,"column":56,"offset":442}}}],"position":{"start":{"line":18,"column":1,"offset":387},"end":{"line":18,"column":56,"offset":442}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a62524a6c6330f2f1f97c2b95f6e8607/d56e1/ecbenc.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 82.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAAB4UlEQVQ4y5XT56oiQRAF4Hn/l1NQBAPmrNecUy9fsb24rn+2oeiZCqdOhS7S7/N4PNLtdkvP5zP+T6dTarfbabFYpNFolKbT6R/b5XIJ+/1+j7j3U3AeDoep3++nXq+XDodDGM7nc5rP52k2m6XxeBzfAF6vV9rv9+Hf7XYjBsZgMEi73S4VnU4njOv1OrKSn5+f0AGl32w2cZPMervdhn61WgX7DF6kLwcToN8Oxrn0zyOmQP94PEZGlImsysgMCB/s6ZfLZfgDwFYM9vyK6/Ua6JPJJJTvAyJ6qsdYYU7E+Aemv/pK5y4YiN4wAnsviSPAnOj9YKQFTo4p0JXJFJWgFKXJRm96SmQDQK98ySVyA4UTgEqiaLVaqVqthrPpyggE80qlEjcbfe6zmHK5HImRYIse+uGsZ26lYQKYYC0xWy49J3bn72CY+yGLif/PCvHXjr9eCmQZ9QMolp4W5kR5zWYz9Hzp2CUCJs53blOR9ye/BKKntv59D4nS9S3vYX4teR8N9utLwTivw+ex2Bh9O8CLer0eyKh7kxj695Yx8K9sg3N7swLZsLZWqimVSsE+9tAuycyAul5gabIan+88ybxO/BERy475PyW/v5JGoxE7KKBWqwWzPHlD+nw5zi9F1hmmxBJQfAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/a62524a6c6330f2f1f97c2b95f6e8607/8ac56/ecbenc.webp 240w,\n/static/a62524a6c6330f2f1f97c2b95f6e8607/d3be9/ecbenc.webp 480w,\n/static/a62524a6c6330f2f1f97c2b95f6e8607/e46b2/ecbenc.webp 960w,\n/static/a62524a6c6330f2f1f97c2b95f6e8607/bbe5b/ecbenc.webp 1130w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/a62524a6c6330f2f1f97c2b95f6e8607/8ff5a/ecbenc.png 240w,\n/static/a62524a6c6330f2f1f97c2b95f6e8607/e85cb/ecbenc.png 480w,\n/static/a62524a6c6330f2f1f97c2b95f6e8607/d9199/ecbenc.png 960w,\n/static/a62524a6c6330f2f1f97c2b95f6e8607/d56e1/ecbenc.png 1130w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/a62524a6c6330f2f1f97c2b95f6e8607/d9199/ecbenc.png\"\n          alt=\"ECBモードの暗号化\"\n          title=\"ECBモードの暗号化\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n  </a>\n    </span>","position":{"start":{"line":20,"column":1,"offset":444},"end":{"line":20,"column":33,"offset":476}}}],"position":{"start":{"line":20,"column":1,"offset":444},"end":{"line":20,"column":33,"offset":476}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"ecbモードが脆弱な理由","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#ecb%E3%83%A2%E3%83%BC%E3%83%89%E3%81%8C%E8%84%86%E5%BC%B1%E3%81%AA%E7%90%86%E7%94%B1","aria-label":"ecbモードが脆弱な理由 permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"ECBモードが脆弱な理由","position":{"start":{"line":22,"column":5,"offset":482},"end":{"line":22,"column":17,"offset":494}}}],"position":{"start":{"line":22,"column":1,"offset":478},"end":{"line":22,"column":17,"offset":494}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"ECBを使うべきでない理由は単に、暗号文を解読することなく平文を操作できるからです。取引データなど同じフォーマットで平文が繰り返されている場合、平文を読むことなく暗号文のパターンを把握し、その順番を入れ替えることで平文を操作できてしまうのです。他のモードであれば暗号文をいじれば平文のメッセージに意味がなくなる場合がほとんどですが、ECBでは意味の通る状態で平文を書き換えられるわけです。","position":{"start":{"line":23,"column":1,"offset":495},"end":{"line":23,"column":195,"offset":689}}}],"position":{"start":{"line":23,"column":1,"offset":495},"end":{"line":23,"column":195,"offset":689}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"cipher-block-chaining-cbc","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#cipher-block-chaining-cbc","aria-label":"cipher block chaining cbc permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Cipher Block Chaining (CBC)","position":{"start":{"line":25,"column":4,"offset":694},"end":{"line":25,"column":31,"offset":721}}}],"position":{"start":{"line":25,"column":1,"offset":691},"end":{"line":25,"column":31,"offset":721}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"CBCは一つ前の暗号文ブロックと平文ブロックのXORをとる方法。これをすることでECBの問題であった「平文のパターンがバレる」という問題は解決します。","position":{"start":{"line":26,"column":1,"offset":722},"end":{"line":26,"column":76,"offset":797}}}],"position":{"start":{"line":26,"column":1,"offset":722},"end":{"line":26,"column":76,"offset":797}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/32db7a4439e1ccb76626f78505245590/43853/cbcenc.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50.83333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABHElEQVQoz2WS2aqEQAxE/f+fmwd9kEFBGRl3cGMWtwwn9wZaDYhtpVOpSvT2fRd7iPf7LV3XybIs+m34NE1SFIW8Xq8DzrtpGinLUms8lwyAxDiOSmwFPJ/PR/Pgdp/Ytk0F5HkuVVWJJ6f4fr+qwhQaKThkZ0LOYDRc11U8rLRtqyDd+MaCq87OqKfonKNZXdd69iBLkkT6vldlFCH9XIStNE1lnufDDAlqsAx2sWyztPnYorhs6lxCRIBb7rKUKIrkdrupYrPDfLDk+748n88DGXnUhWGoo7sQPh4PTQ7DoBhkBHO93+9a7JIRWZZJEAT/W97lMhP7ZVjQefiWt0bupv8sO2SAdGNJWHR/buzEcax5U2/NuIty7vwA2G0KpsigADEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/32db7a4439e1ccb76626f78505245590/8ac56/cbcenc.webp 240w,\n/static/32db7a4439e1ccb76626f78505245590/d3be9/cbcenc.webp 480w,\n/static/32db7a4439e1ccb76626f78505245590/e46b2/cbcenc.webp 960w,\n/static/32db7a4439e1ccb76626f78505245590/f992d/cbcenc.webp 1440w,\n/static/32db7a4439e1ccb76626f78505245590/882b9/cbcenc.webp 1920w,\n/static/32db7a4439e1ccb76626f78505245590/38679/cbcenc.webp 2284w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/32db7a4439e1ccb76626f78505245590/8ff5a/cbcenc.png 240w,\n/static/32db7a4439e1ccb76626f78505245590/e85cb/cbcenc.png 480w,\n/static/32db7a4439e1ccb76626f78505245590/d9199/cbcenc.png 960w,\n/static/32db7a4439e1ccb76626f78505245590/07a9c/cbcenc.png 1440w,\n/static/32db7a4439e1ccb76626f78505245590/29114/cbcenc.png 1920w,\n/static/32db7a4439e1ccb76626f78505245590/43853/cbcenc.png 2284w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/32db7a4439e1ccb76626f78505245590/d9199/cbcenc.png\"\n          alt=\"CBCモードの暗号化\"\n          title=\"CBCモードの暗号化\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n  </a>\n    </span>","position":{"start":{"line":28,"column":1,"offset":799},"end":{"line":28,"column":33,"offset":831}}}],"position":{"start":{"line":28,"column":1,"offset":799},"end":{"line":28,"column":33,"offset":831}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"復号はこれを逆に実行すれば良いだけですが、ビットが破損した場合その平文と、破損した暗号文とXORを取る平文の二つの復号に影響が出ます。また暗号文のビットが欠落した場合、その後の暗号文ブロックが全てズレて復号してもわけが分からなくなります。","position":{"start":{"line":30,"column":1,"offset":833},"end":{"line":30,"column":120,"offset":952}}}],"position":{"start":{"line":30,"column":1,"offset":833},"end":{"line":30,"column":120,"offset":952}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"図にあるように最初は「初期化ベクトル」なるランダムなビット列と平文でXORをとります。この初期化ベクトルがランダムでないと1ブロック目に同じ平文が来た時に同じ暗号文ブロックが出力されてしまうので、ECB同様攻撃者に情報を与えてしまうことになります。","position":{"start":{"line":32,"column":1,"offset":954},"end":{"line":32,"column":125,"offset":1078}}}],"position":{"start":{"line":32,"column":1,"offset":954},"end":{"line":32,"column":125,"offset":1078}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"cbcの弱点","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#cbc%E3%81%AE%E5%BC%B1%E7%82%B9","aria-label":"cbcの弱点 permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"CBCの弱点","position":{"start":{"line":34,"column":5,"offset":1084},"end":{"line":34,"column":11,"offset":1090}}}],"position":{"start":{"line":34,"column":1,"offset":1080},"end":{"line":34,"column":11,"offset":1090}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"初期化ベクトルをいじることができれば、最初の平文の1ビットごとの操作が可能になります。","position":{"start":{"line":35,"column":1,"offset":1091},"end":{"line":35,"column":44,"offset":1134}}},{"type":"element","tagName":"a","properties":{"href":"https://jvndb.jvn.jp/ja/contents/2011/JVNDB-2011-002305.html","target":"_blank","rel":"nofollow noopener noreferrer"},"children":[{"type":"text","value":"TLS1.0では前回暗号化した最後のブロックを初期化ベクトルとして用いていた","position":{"start":{"line":35,"column":45,"offset":1135},"end":{"line":35,"column":83,"offset":1173}}}],"position":{"start":{"line":35,"column":44,"offset":1134},"end":{"line":35,"column":146,"offset":1236}}},{"type":"text","value":"のでこの攻撃が可能でしたが、先述の通り正しく実装されていれば初期化ベクトルはランダム生成なのでほとんどの場合不可能でしょう。","position":{"start":{"line":35,"column":146,"offset":1236},"end":{"line":35,"column":208,"offset":1298}}}],"position":{"start":{"line":35,"column":1,"offset":1091},"end":{"line":35,"column":208,"offset":1298}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"また平文をブロックの整数倍に合わせる際のパディング内容を若干変化させながら暗号文を送信し、そのエラー文から平文情報を得る","position":{"start":{"line":37,"column":1,"offset":1300},"end":{"line":37,"column":61,"offset":1360}}},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"パディングオラクル攻撃","position":{"start":{"line":37,"column":63,"offset":1362},"end":{"line":37,"column":74,"offset":1373}}}],"position":{"start":{"line":37,"column":61,"offset":1360},"end":{"line":37,"column":76,"offset":1375}}},{"type":"text","value":"の対象にもなります。パディングオラクル攻撃に関しては、デジタル署名なりで送り手を認証し、変な送信元だったら抽象的なエラーメッセージしか返さないことで対策できます。","position":{"start":{"line":37,"column":76,"offset":1375},"end":{"line":37,"column":157,"offset":1456}}}],"position":{"start":{"line":37,"column":1,"offset":1300},"end":{"line":37,"column":157,"offset":1456}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"さらに、複数の暗号文ブロックをすり替えた時に最初の平文ブロック以外は正しく復号できてしまうので平文を書き換えることができてしまいます。これを","position":{"start":{"line":39,"column":1,"offset":1458},"end":{"line":39,"column":71,"offset":1528}}},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"再生攻撃","position":{"start":{"line":39,"column":73,"offset":1530},"end":{"line":39,"column":77,"offset":1534}}}],"position":{"start":{"line":39,"column":71,"offset":1528},"end":{"line":39,"column":79,"offset":1536}}},{"type":"text","value":"と言います。","position":{"start":{"line":39,"column":79,"offset":1536},"end":{"line":39,"column":85,"offset":1542}}}],"position":{"start":{"line":39,"column":1,"offset":1458},"end":{"line":39,"column":85,"offset":1542}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"セキュリティ以外で言えば、前の暗号文ブロックを利用するため並列処理ができない点は痛いですね。","position":{"start":{"line":41,"column":1,"offset":1544},"end":{"line":41,"column":47,"offset":1590}}}],"position":{"start":{"line":41,"column":1,"offset":1544},"end":{"line":41,"column":47,"offset":1590}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"cipher-text-stealing-cts","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#cipher-text-stealing-cts","aria-label":"cipher text stealing cts permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Cipher Text Stealing (CTS)","position":{"start":{"line":43,"column":4,"offset":1595},"end":{"line":43,"column":30,"offset":1621}}}],"position":{"start":{"line":43,"column":1,"offset":1592},"end":{"line":43,"column":30,"offset":1621}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"パディングに前の暗号文ブロックの末尾を用いる方法。ECBモードやCBCモードと組み合わせて使うモードで、パディングに利用したブロックの部分は暗号文としては使用しません。CTSモードを使っていることが分かっていれば、末尾の特定のサイズはXORにかけずその前の暗号文の末尾として復号を進めれば良いので復号も問題なくできます。","position":{"start":{"line":44,"column":1,"offset":1622},"end":{"line":44,"column":161,"offset":1782}}}],"position":{"start":{"line":44,"column":1,"offset":1622},"end":{"line":44,"column":161,"offset":1782}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a0c67a5d7dbb1ab732b412716b77fb4c/7ebf9/ctsenc.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 72.08333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAABmUlEQVQ4y22T6aoCMQyF+/4P5h/BBUUFQRH3Xcd9m3i/6CnTi2FKp0lzcrI0XK9X2263tlwu7fV6mYT/3W7n+tvt5jr21Wpl+/0+3svzXD++wvF4tPv9bufz2QBnXS4Xv4Oe/9Pp5AvhPBgMbDgcRsD8C2Z/X1AEHA6Hg2VZFp0JQkAWeoSA4/HYZrNZAvjByT+AAgVA7KQTw6LM53MHThh+044M2Uejka3X6wRwOp1GNgjsOp3OT8C8CAgLAElbghP1ojEIqdModgLVarUkIwdUR5/PZ4yqC+gfj4cvhDoCRmkWi4VVq1VPn3NkqDrBrlKpWKPR8LQx4lSv163ZbPpobTYbD4y9ODrYdA6wIF0ut9tt6/V6boQVOurVarUcFD32Uqlk5XI5qS02MgjQ1eASibSZP5Y6TyBsmk3qSK31ENQH7gQAUHDo9/s2mUxip3EixW636wyl0xxqnARIRkEKUsRZS/NGN6kvDSA4IATEWc0QO2xxbH4JNpzUZYCK710TAjjd96b8fz7pU0qF+uFMA/RUCVIc8jeEaTxNKai9nwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/a0c67a5d7dbb1ab732b412716b77fb4c/8ac56/ctsenc.webp 240w,\n/static/a0c67a5d7dbb1ab732b412716b77fb4c/d3be9/ctsenc.webp 480w,\n/static/a0c67a5d7dbb1ab732b412716b77fb4c/e46b2/ctsenc.webp 960w,\n/static/a0c67a5d7dbb1ab732b412716b77fb4c/f992d/ctsenc.webp 1440w,\n/static/a0c67a5d7dbb1ab732b412716b77fb4c/03046/ctsenc.webp 1919w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/a0c67a5d7dbb1ab732b412716b77fb4c/8ff5a/ctsenc.png 240w,\n/static/a0c67a5d7dbb1ab732b412716b77fb4c/e85cb/ctsenc.png 480w,\n/static/a0c67a5d7dbb1ab732b412716b77fb4c/d9199/ctsenc.png 960w,\n/static/a0c67a5d7dbb1ab732b412716b77fb4c/07a9c/ctsenc.png 1440w,\n/static/a0c67a5d7dbb1ab732b412716b77fb4c/7ebf9/ctsenc.png 1919w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/a0c67a5d7dbb1ab732b412716b77fb4c/d9199/ctsenc.png\"\n          alt=\"CTSモードの暗号化\"\n          title=\"CTSモードの暗号化\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n  </a>\n    </span>","position":{"start":{"line":46,"column":1,"offset":1784},"end":{"line":46,"column":33,"offset":1816}}}],"position":{"start":{"line":46,"column":1,"offset":1784},"end":{"line":46,"column":33,"offset":1816}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"cipher-feedback-cfb","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#cipher-feedback-cfb","aria-label":"cipher feedback cfb permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Cipher-FeedBack (CFB)","position":{"start":{"line":48,"column":4,"offset":1821},"end":{"line":48,"column":25,"offset":1842}}}],"position":{"start":{"line":48,"column":1,"offset":1818},"end":{"line":48,"column":25,"offset":1842}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"一つ前の暗号文ブロックを暗号アルゴリズムの入力にし、それと平文のXORをとって暗号文ブロックとする方法。一見平文から暗号文ブロックを生成する間に暗号化がないので不安になりますが（少なくとも僕はなった）その後で暗号文ブロックを暗号化する処理があるので結果的には暗号アルゴリズムの恩恵を受けられる仕組みになっています。","position":{"start":{"line":49,"column":1,"offset":1843},"end":{"line":49,"column":158,"offset":2000}}}],"position":{"start":{"line":49,"column":1,"offset":1843},"end":{"line":49,"column":158,"offset":2000}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/582b9f69d02e46144387fdda127add62/86a2d/cfbenc.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA5klEQVQoz1WR2aqGMAyE+/6vJ4qC1yqC4L5rzvkCI/0jNWknyyQJr/1/72vI8zw2z7ON4+i2BHzfd7vv+7sj13XZtm3uP02TnedpAVAOgMMwuMY5DsZ5WRY/cTHFkZTYEANiQjIlksCOwOM4PkxaGDrw4whUQgXEiQkSO3SMr+vqb6EsS0uSxPq+97bquvY5IkVRWJqm3ibMqqr6mGRZZnmef6NomsZ9AoziJcTDJ3HXdT+YbJIQJwGDbaA9XbRl3bUMtcgmYaG7CmNTwLfctq3T1cBpGVbMhDclxBaGrXlSGF8wxvYHp5dw5lr0Kw0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/582b9f69d02e46144387fdda127add62/8ac56/cfbenc.webp 240w,\n/static/582b9f69d02e46144387fdda127add62/d3be9/cfbenc.webp 480w,\n/static/582b9f69d02e46144387fdda127add62/e46b2/cfbenc.webp 960w,\n/static/582b9f69d02e46144387fdda127add62/f992d/cfbenc.webp 1440w,\n/static/582b9f69d02e46144387fdda127add62/882b9/cfbenc.webp 1920w,\n/static/582b9f69d02e46144387fdda127add62/6fac3/cfbenc.webp 3027w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/582b9f69d02e46144387fdda127add62/8ff5a/cfbenc.png 240w,\n/static/582b9f69d02e46144387fdda127add62/e85cb/cfbenc.png 480w,\n/static/582b9f69d02e46144387fdda127add62/d9199/cfbenc.png 960w,\n/static/582b9f69d02e46144387fdda127add62/07a9c/cfbenc.png 1440w,\n/static/582b9f69d02e46144387fdda127add62/29114/cfbenc.png 1920w,\n/static/582b9f69d02e46144387fdda127add62/86a2d/cfbenc.png 3027w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/582b9f69d02e46144387fdda127add62/d9199/cfbenc.png\"\n          alt=\"CFBモードの暗号化\"\n          title=\"CFBモードの暗号化\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n  </a>\n    </span>","position":{"start":{"line":51,"column":1,"offset":2002},"end":{"line":51,"column":33,"offset":2034}}}],"position":{"start":{"line":51,"column":1,"offset":2002},"end":{"line":51,"column":33,"offset":2034}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"復号の際は同じように、前の暗号文ブロックを","position":{"start":{"line":53,"column":1,"offset":2036},"end":{"line":53,"column":22,"offset":2057}}},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"暗号化","position":{"start":{"line":53,"column":24,"offset":2059},"end":{"line":53,"column":27,"offset":2062}}}],"position":{"start":{"line":53,"column":22,"offset":2057},"end":{"line":53,"column":29,"offset":2064}}},{"type":"text","value":"したビット列と暗号文のXORをとって平文を取得します。ここで、XORで同じ値を出力するには暗号化の際と同じ値が必要なため、前の暗号文ブロックを復号ではなく暗号化するのです。","position":{"start":{"line":53,"column":29,"offset":2064},"end":{"line":53,"column":115,"offset":2150}}}],"position":{"start":{"line":53,"column":1,"offset":2036},"end":{"line":53,"column":115,"offset":2150}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"図を見るとわかる通り、平文から暗号文を導出する時はXORをとって1ビットずつ生成しています。なのでCFBモードはストリーム暗号を作っているとみなせるのです。","position":{"start":{"line":55,"column":1,"offset":2152},"end":{"line":55,"column":79,"offset":2230}}}],"position":{"start":{"line":55,"column":1,"offset":2152},"end":{"line":55,"column":79,"offset":2230}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"cfbの弱点","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#cfb%E3%81%AE%E5%BC%B1%E7%82%B9","aria-label":"cfbの弱点 permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"CFBの弱点","position":{"start":{"line":57,"column":5,"offset":2236},"end":{"line":57,"column":11,"offset":2242}}}],"position":{"start":{"line":57,"column":1,"offset":2232},"end":{"line":57,"column":11,"offset":2242}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"CBC同様に再生攻撃のリスクと、並列処理ができないという欠点があります。また、暗号文の1ビットを反転させると平文の1ビットも反転するという脆弱性があります。","position":{"start":{"line":58,"column":1,"offset":2243},"end":{"line":58,"column":79,"offset":2321}}}],"position":{"start":{"line":58,"column":1,"offset":2243},"end":{"line":58,"column":79,"offset":2321}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"output-feedback-ofb","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#output-feedback-ofb","aria-label":"output feedback ofb permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Output-FeedBack (OFB)","position":{"start":{"line":60,"column":4,"offset":2326},"end":{"line":60,"column":25,"offset":2347}}}],"position":{"start":{"line":60,"column":1,"offset":2323},"end":{"line":60,"column":25,"offset":2347}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"前の暗号アルゴリズムの出力を入力として鍵ストリームを作成し、それと平文のXORをとって暗号文とする方法。先に鍵ストリームを作っておくことができ、そうすればあとはXORをとるだけなので非常に高速化かつ並列処理が可能になります。","position":{"start":{"line":61,"column":1,"offset":2348},"end":{"line":61,"column":113,"offset":2460}}}],"position":{"start":{"line":61,"column":1,"offset":2348},"end":{"line":61,"column":113,"offset":2460}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b9bf8d4441ed399ff620add1c99a531b/b4aee/ofbenc.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 80.41666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAABn0lEQVQ4y52U64rCQAyF5/1fTUEU/KOCivd7q9a7zfoNe7rRdmHZgeD0THImOZMYZrOZ9ft9G4/HdrvdjJXn+Z9N/sb2ZYGP3W5n9/vd/rNEWhBOp1Or1+sxy8PhYNfr1SaTiXW73Wir1Spi6/Xaer2edTqdeL7f7+35fLqKvglxqNVq1mq1bLlcWpIkNhgMrNFoRAxJqIDfdrttzWYzXp5lWVGVlyD49NHwcrmUyjqdTiUMsiqZgheX0s7nsz0ej7iHnCCyoTyPycBJRFYiJAAt5/N5lCBN03gJNhwObTQa2Xa7LSoCRw78wUPuXkoZcjNaoh0YJYMdj8d4DhExnKkCfDkLvIwnlF5kKj2FUZ4wYrQHhzRqyFv/RsiNLDkrcxHqHM3JsJJQJTE5i8WiIASjZzEyIkY4vYq24C8N30eIDMkCMmXDRegHRrD8IePReAzOYh++zeNHn0Hkl1qnyl9Shdw9im8htYoP5puW+vRFQzL9IdRsu0B6ENPNlMcMo6GChTPnmu/g/igKQrJAFzRUsAI3m03xouoG9APD9wsi493EvWol8QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/b9bf8d4441ed399ff620add1c99a531b/8ac56/ofbenc.webp 240w,\n/static/b9bf8d4441ed399ff620add1c99a531b/d3be9/ofbenc.webp 480w,\n/static/b9bf8d4441ed399ff620add1c99a531b/e46b2/ofbenc.webp 960w,\n/static/b9bf8d4441ed399ff620add1c99a531b/f992d/ofbenc.webp 1440w,\n/static/b9bf8d4441ed399ff620add1c99a531b/1a539/ofbenc.webp 1823w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/b9bf8d4441ed399ff620add1c99a531b/8ff5a/ofbenc.png 240w,\n/static/b9bf8d4441ed399ff620add1c99a531b/e85cb/ofbenc.png 480w,\n/static/b9bf8d4441ed399ff620add1c99a531b/d9199/ofbenc.png 960w,\n/static/b9bf8d4441ed399ff620add1c99a531b/07a9c/ofbenc.png 1440w,\n/static/b9bf8d4441ed399ff620add1c99a531b/b4aee/ofbenc.png 1823w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/b9bf8d4441ed399ff620add1c99a531b/d9199/ofbenc.png\"\n          alt=\"OFBモードの暗号化\"\n          title=\"OFBモードの暗号化\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n  </a>\n    </span>","position":{"start":{"line":63,"column":1,"offset":2462},"end":{"line":63,"column":33,"offset":2494}}}],"position":{"start":{"line":63,"column":1,"offset":2462},"end":{"line":63,"column":33,"offset":2494}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"ofbの弱点","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#ofb%E3%81%AE%E5%BC%B1%E7%82%B9","aria-label":"ofbの弱点 permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"OFBの弱点","position":{"start":{"line":65,"column":5,"offset":2500},"end":{"line":65,"column":11,"offset":2506}}}],"position":{"start":{"line":65,"column":1,"offset":2496},"end":{"line":65,"column":11,"offset":2506}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"再生攻撃などの弱点は克服していますが、暗号文のビット反転が平文のビットに影響するという弱点は変わりません。","position":{"start":{"line":66,"column":1,"offset":2507},"end":{"line":66,"column":54,"offset":2560}}}],"position":{"start":{"line":66,"column":1,"offset":2507},"end":{"line":66,"column":54,"offset":2560}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"counter-ctr","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#counter-ctr","aria-label":"counter ctr permalink","class":"anchor before"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"CounTeR (CTR)","position":{"start":{"line":68,"column":4,"offset":2565},"end":{"line":68,"column":17,"offset":2578}}}],"position":{"start":{"line":68,"column":1,"offset":2562},"end":{"line":68,"column":17,"offset":2578}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"暗号化のたびに増加するカウンタを用いて鍵ストリームを生成する方法です。CFBやOFB同様、機能的にはストリーム暗号です。","position":{"start":{"line":69,"column":1,"offset":2579},"end":{"line":69,"column":61,"offset":2639}}}],"position":{"start":{"line":69,"column":1,"offset":2579},"end":{"line":69,"column":61,"offset":2639}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"毎度nonceを生成し、その後にカウンタを挿入します。128bitsのブロック長だった場合、前半8bitsがnonce、後半8bitsがカウンターになります。","position":{"start":{"line":71,"column":1,"offset":2641},"end":{"line":71,"column":80,"offset":2720}}}],"position":{"start":{"line":71,"column":1,"offset":2641},"end":{"line":71,"column":80,"offset":2720}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\":初期値の例\"><pre class=\"language-:初期値の例\"><code class=\"language-:初期値の例\">6d 5f 17 f1 24 c7 bb 4e 00 00 00 00 00 00 00 01</code></pre></div>","position":{"start":{"line":73,"column":1,"offset":2722},"end":{"line":75,"column":4,"offset":2783}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"raw","value":"<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9190c909a07c26f123973330d69866fc/05d4a/ctrenc.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 67.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAABmUlEQVQ4y22T6YoCQQyE+/3fSwQVBPWX94x4Ih7jNYdO9Guo3nZ3I6HHVCepHO3SNLUkSayqKkPquvbnfr/39tlsZtfrNWCv18tWq5WNx2ObTqdWlmXAcHXH49FQLv4AteV5bufz2S6XS0gm/PF42OFwsNvt9u33+TnA2Bif9/v9j00nCeMk/vyoa7fb1uv1AnUFP51O1mq1rN/ve0ax43q9tmazaaPRyJ7P51dlrtPpWLfbDQEl9LDRaPig6qGEvoMNBoMQUOLECIASi6II5cSssfOfE1Ff8cPOic3hzAdlTSYTP9X5fO7p03QuMhjKGw6HtlgsfCAwhOHghy6XS3NkxIkAfHNB2XHiW8GZukqECMxRMNoSGMZls2MSMVT5m80mDCCestbI9xBW9A5lepSm3hEQxYFEtEMJsOMDM0oVEUc2qJKRC6xLvHMaRJZl/gEIIzB2krERgaH9EhzjnZMQgGT/YSTVkJxAMlESb5TS1VdhvGsmudvtwhIjlAzGZtBjFz8lDNBHYycCglHWdrv9wqiIHuLDnTcmEju8n0kN2gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/9190c909a07c26f123973330d69866fc/8ac56/ctrenc.webp 240w,\n/static/9190c909a07c26f123973330d69866fc/d3be9/ctrenc.webp 480w,\n/static/9190c909a07c26f123973330d69866fc/e46b2/ctrenc.webp 960w,\n/static/9190c909a07c26f123973330d69866fc/f992d/ctrenc.webp 1440w,\n/static/9190c909a07c26f123973330d69866fc/2ce43/ctrenc.webp 1861w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/9190c909a07c26f123973330d69866fc/8ff5a/ctrenc.png 240w,\n/static/9190c909a07c26f123973330d69866fc/e85cb/ctrenc.png 480w,\n/static/9190c909a07c26f123973330d69866fc/d9199/ctrenc.png 960w,\n/static/9190c909a07c26f123973330d69866fc/07a9c/ctrenc.png 1440w,\n/static/9190c909a07c26f123973330d69866fc/05d4a/ctrenc.png 1861w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/9190c909a07c26f123973330d69866fc/d9199/ctrenc.png\"\n          alt=\"CTRモードの暗号化\"\n          title=\"CTRモードの暗号化\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n  </a>\n    </span>","position":{"start":{"line":77,"column":1,"offset":2785},"end":{"line":77,"column":33,"offset":2817}}}],"position":{"start":{"line":77,"column":1,"offset":2785},"end":{"line":77,"column":33,"offset":2817}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":78,"column":1,"offset":2818}}}}